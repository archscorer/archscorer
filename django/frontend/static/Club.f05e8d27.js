import{f as a,g as i,ax as $,a as o,ay as k,q as b,aN as y,j as c,y as h,z as f,A,h as _,o as C,aD as I,az as E,x as M}from"./index.9f0192f4.js";import{_ as v}from"./VDialog.a6eae2af.js";import{_ as u,a as l}from"./VRow.852a78ce.js";import{_ as m}from"./VTextarea.c55cf8c2.js";import{a as g}from"./archerDetails.9a1ce945.js";import{a as S}from"./VSelect.ae1c9e61.js";import{_ as T}from"./VDataTable.a36d605b.js";import{_ as w}from"./VForm.2dc4e611.js";import"./VChip.740d662b.js";var j=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t(v,{attrs:{fullscreen:"","hide-overlay":""},scopedSlots:e._u([{key:"activator",fn:function(n){var r=n.on;return[t(a,e._g({staticClass:"mx-2",attrs:{color:"warning"},on:{click:function(O){return e.c_edit()}}},r),[e._v("Edit club")])]}}]),model:{value:e.dialog,callback:function(n){e.dialog=n},expression:"dialog"}},[t(i,[t($,{attrs:{dark:"",color:"primary"}},[t(a,{attrs:{icon:"",dark:""},on:{click:function(n){e.dialog=!1}}},[t(o,[e._v("mdi-close")])],1),t(k,[e._v("Edit "+e._s(e.club.name))]),t(b),t(y,[t(a,{attrs:{dark:"",text:""},on:{click:function(n){e.putClub(e.club),e.dialog=!1}}},[e._v("Save")])],1)],1),t(i,{staticClass:"ma-5"},[t(c,[t(u,[t(l,{attrs:{cols:"12"}},[t(m,{attrs:{outlined:"",label:"Contact information","auto-grow":""},model:{value:e.club.contact,callback:function(n){e.$set(e.club,"contact",n)},expression:"club.contact"}})],1)],1),t(u,[t(l,{attrs:{cols:"12"}},[t(m,{attrs:{outlined:"",label:"Club description","auto-grow":""},model:{value:e.club.description,callback:function(n){e.$set(e.club,"description",n)},expression:"club.description"}})],1)],1)],1)],1)],1)],1)},V=[];const z={data:()=>({dialog:!1,club:{}}),computed:{p_club(){return this.$store.getters["clubs/clubById"](parseInt(this.$route.params.id))}},methods:{...h("clubs",["putClub"]),c_edit(){this.club=Object.assign({},this.p_club)}}},d={};var P=f(z,j,V,!1,D,null,null,null);function D(e){for(let s in d)this[s]=d[s]}var x=function(){return P.exports}(),N=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.club?t(A,[t(i,[t(_,{domProps:{textContent:e._s(e.club.name+" ("+e.club.name_short+")")}}),t(c,[t("p",{domProps:{innerHTML:e._s(e.club.contact)}}),t("p",{domProps:{innerHTML:e._s(e.club.description)}}),e.user_is_member_or_admin?[t(u,[t(l,{attrs:{cols:"8"}},[e.club.admins&&e.club.admins.includes(e.user.email)?[t(x),t(a,{staticClass:"mx-2",attrs:{color:"primary"},on:{click:function(n){return e.addA()}}},[e._v("Add member")])]:e._e()],2),t(l,{attrs:{cols:"4"}},[t(S,{attrs:{"append-icon":"mdi-magnify",label:"Search member","single-line":"","hide-details":""},model:{value:e.m_search,callback:function(n){e.m_search=n},expression:"m_search"}})],1)],1),t(T,{attrs:{dense:"",headers:e.m_table_header,items:e.m_table,search:e.m_search,"items-per-page":50,"multi-sort":""},scopedSlots:e._u([{key:"item.ops",fn:function(n){return[e.club.admins.includes(e.user.email)?[t(o,{staticClass:"mr-2",attrs:{small:""},on:{click:function(r){return e.editA(n.item.id)}}},[e._v(" mdi-pencil ")]),n.item.events?e._e():t(o,{attrs:{small:""},on:{click:function(r){return e.deleteA(n.item.id)}}},[e._v(" mdi-delete ")])]:e._e()]}}],null,!1,1003564087)})]:t("p",[e._v(" Club member list is visible only to club members and club administrators. Also you need to be logged in! ")])],2)],1),t(v,{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(n){e.dialog=n},expression:"dialog"}},[t(i,[t(_,[e._v("Edit Archer profile")]),t(c,[t(w,{model:{value:e.valid,callback:function(n){e.valid=n},expression:"valid"}},[t(g,{attrs:{clubs:[{name:"*_kick out_*",id:1},e.club]},model:{value:e.a_edit,callback:function(n){e.a_edit=n},expression:"a_edit"}})],1)],1),t(C,[t(b),t(a,{attrs:{text:""},on:{click:function(n){e.dialog=!1}}},[e._v("Cancel")]),t(a,{attrs:{color:"primary",text:""},on:{click:function(n){e.putMember(e.a_edit),e.dialog=!1}}},[e._v(e._s(e.action))])],1)],1)],1)],1):t(I,[t(E,{attrs:{indeterminate:"",size:"64"}})],1)},B=[];const F={components:{clubEdit:x,archerDetails:g},data:()=>({m_search:"",valid:!1,action:"",dialog:!1,a_edit:{}}),computed:{...M({user:e=>e.user.user}),club(){return this.$store.getters["clubs/clubById"](parseInt(this.$route.params.id))},m_table_header(){let e=[{text:"Name",value:"full_name"},{text:"Activity",value:"events",width:"90px"}];return this.club.admins.includes(this.user.email)&&e.push({text:"Gender",value:"gender"},{text:"E-mail",value:"email"},{text:"Phone",value:"phone"},{text:"National ID",value:"nat_id"},{text:"Edit",value:"ops",sortable:!1,width:"80px"}),e},m_table(){return Array.isArray(this.club.members)?this.club.members.map(function(e){let s={full_name:e.full_name,events:e.events.length?e.events.length:null};return this.club.admins.includes(this.user.email)?Object.assign(s,{id:e.id,gender:e.gender,email:e.email,phone:e.phone,nat_id:e.nat_id}):s},this):[]},user_is_member_or_admin(){return!this.user.id||this.user.email===""?!1:this.club.admins&&this.club.admins.includes(this.user.email)?!0:Array.isArray(this.club.members)?this.club.members.map(e=>e.email).includes(this.user.email)||this.club.members.map(e=>e.email).includes(this.user.archer.email):!1}},methods:{...h("clubs",["putMember","delMember"]),editA(e){this.a_edit=this.club.members.find(s=>s.id===e),this.action="Save changes",this.dialog=!0},deleteA(e){let s=this.club.members.find(t=>t.id===e);confirm(s.full_name+" will be permanently deleted. This action can not be undone!")&&this.delMember({aId:s.id,cId:s.club})},addA(){this.a_edit={id:null,full_name:"",gender:"",club:this.club.id,email:"",phone:"",nat_id:""},this.action="Add archer",this.dialog=!0}},created(){this.$store.dispatch("clubs/updateClub",parseInt(this.$route.params.id)).catch(()=>{this.$router.push("/clubs")})}},p={};var H=f(F,N,B,!1,L,null,null,null);function L(e){for(let s in p)this[s]=p[s]}var Y=function(){return H.exports}();export{Y as default};
