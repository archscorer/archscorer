import{g as p,h as k,q as S,j as m,n as c,x as v,z as h,A as $}from"./index.9f0192f4.js";import{a as g}from"./archerSearch.0a7091b2.js";import{r as C}from"./rankingService.45c233ea.js";import{_ as u,a as l}from"./VRow.852a78ce.js";import{_}from"./VDataTable.a36d605b.js";import"./VAutocomplete.82f8fa50.js";import"./VSelect.ae1c9e61.js";import"./VChip.740d662b.js";var A=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t(p,{staticClass:"mt-5"},[t(k,[e._v(" Showing past rounds for "+e._s(e.target_name)+" "),t(S),t(g,{model:{value:e.archer,callback:function(r){e.archer=r},expression:"archer"}})],1),t(m,[e.classifications.length?t(u,{attrs:{dense:""}},[t(l,[e._v(" Archer has the following classification levels: "),t(_,{attrs:{dense:"","mobile-breakpoint":300,headers:e.c_table_header,items:e.c_table,"hide-default-footer":""},scopedSlots:e._u([{key:"item.level",fn:function(r){return[t("span",{staticClass:"font-weight-medium"},[e._v(e._s(r.item.level))])]}}],null,!1,203868193)}),t("small",[t("p",[e._v(" * See "),t("a",{attrs:{href:"https://www.ifaa-archery.org/documents/rule-book/book-of-rules/",target:"_blank"}},[e._v("2021 Book of Rules")]),e._v(" pages 61-62 for more information. ")])])],1)],1):e._e(),t(u,{attrs:{dense:""}},[t(l,[t(c,{staticClass:"switch-label-size",attrs:{dense:"",color:"primary",label:"show only official rounds"},model:{value:e.filter_official,callback:function(r){e.filter_official=r},expression:"filter_official"}})],1),t(l,[t(c,{staticClass:"switch-label-size",attrs:{dense:"",color:"primary",label:"show only my best rounds"},model:{value:e.filter_best,callback:function(r){e.filter_best=r},expression:"filter_best"}})],1)],1),t(_,{attrs:{dense:"","mobile-breakpoint":300,headers:e.p_table_header,items:e.p_table,"items-per-page":5,"multi-sort":""},scopedSlots:e._u([{key:"item.event",fn:function(r){return[t("router-link",{attrs:{to:{name:"event",params:{id:r.item.eId}}}},[e._v(e._s(r.item.event))])]}}])})],1)],1)},I=[];const R={components:{archerSearch:g},data:()=>({archer:null,target_name:"",filter_official:null,filter_best:null}),watch:{archer:function(e){e&&e.events&&(this.target_name=this.archer.full_name,this.$store.dispatch("events/getParticipants",{aId:e.id}),this.$store.dispatch("user/getArcherClassification",{aId:e.id,date:new Date().toISOString().slice(0,10)}))}},computed:{...v({user:e=>e.user.user,participants:e=>e.events.participants,events:e=>e.events.events,courses:e=>e.courses.courses,classifications:e=>e.user.classifications}),p_table_header(){return[{text:"Event",value:"event"},{text:"Date",value:"date",width:"120px"},{text:"Class",value:"class"},{text:"Format",value:"format"},{text:"Score",value:"score"}]},p_table(){let e=[];if(this.participants.length)for(let s of this.participants){let t=this.events.find(r=>r.id===s.event);if(t){let r=[];for(let n of s.scorecards){let x=t.rounds.find(a=>a.id===n.round),i=this.courses.find(a=>a.id===x.course),o=n.score,y=i.name;if(i.type!=="s"){if(i.type==="u"){let a=r.findIndex(w=>w.id===i.id);if(a===-1){r.push({id:i.id,score:o});continue}else o=r[a].score+o,r.splice(a,1)}!o||this.filter_official&&!t.records||e.push({eId:t.id,event:t.name,date:t.date_start,class:C.getClass(s,t.ignore_gender),format:y.replace(/ (Round|Unit)( (Unm|M)arked Distances)? \(.*?\)/,"$2"),score:o})}}}}return this.filter_best&&(e=e.reduce((s,t)=>{let r=s.findIndex(n=>n.class===t.class&&n.format===t.format);return r===-1?s.push(t):s[r].score<t.score&&(s[r]=t),s},[])),e.sort(function(s,t){return s.date<t.date?1:s.date>t.date?-1:0})},c_table_header(){return[{text:"Age Group",value:"age_group"},{text:"Style",value:"style"},{text:"Level",value:"level"},{text:"Date",value:"date"},{text:"Valid for",value:"valid_for"}]},c_table(){let e=[];if(this.classifications.length)for(let s of this.classifications)e.push({date:s.date,age_group:s.age_group,style:s.style,level:s.level,valid_for:s.valid_for>0?s.valid_for+(s.valid_for>1?" days":" day"):"ends today"});return e.sort(function(s,t){return s.date<t.date?1:s.date>t.date?-1:0})}},created(){this.archer=this.user.archer,this.$store.dispatch("events/getEvents")}},f={};var z=h(R,A,I,!1,D,"c097c578",null,null);function D(e){for(let s in f)this[s]=f[s]}var b=function(){return z.exports}(),E=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t($,[t(p,[t(m,[t("p",[e._v("Work in progress. Ideas what kind of statistics or graphs to collect or show would be most wolcome.")])])],1),e.user.id!==null?t(b):e._e()],1)},F=[];const M={name:"ArcherRounds",components:{ArcherPastRounds:b},data:()=>({}),computed:{...v({user:e=>e.user.user})}},d={};var P=h(M,E,F,!1,V,null,null,null);function V(e){for(let s in d)this[s]=d[s]}var W=function(){return P.exports}();export{W as default};
