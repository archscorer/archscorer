import{f as i,g as a,ax as k,a as o,ay as y,q as h,aN as A,j as c,y as f,z as v,A as C,h as _,o as I,aD as E,az as M,x as S}from"./index.27d05026.js";import{_ as g}from"./VDialog.c566c3f1.js";import{_ as u,a as l}from"./VRow.ad1e4ebc.js";import{_ as m}from"./VTextarea.969dd05a.js";import{a as x}from"./archerDetails.92baa0b5.js";import{p as d}from"./purify.es.c2745514.js";import{a as T}from"./VSelect.1eec61dd.js";import{_ as w}from"./VDataTable.ac0f2e23.js";import{_ as z}from"./VForm.09259be3.js";import"./VChip.0fc94f43.js";var j=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t(g,{attrs:{fullscreen:"","hide-overlay":""},scopedSlots:e._u([{key:"activator",fn:function(n){var r=n.on;return[t(i,e._g({staticClass:"mx-2",attrs:{color:"warning"},on:{click:function(R){return e.c_edit()}}},r),[e._v("Edit club")])]}}]),model:{value:e.dialog,callback:function(n){e.dialog=n},expression:"dialog"}},[t(a,[t(k,{attrs:{dark:"",color:"primary"}},[t(i,{attrs:{icon:"",dark:""},on:{click:function(n){e.dialog=!1}}},[t(o,[e._v("mdi-close")])],1),t(y,[e._v("Edit "+e._s(e.club.name))]),t(h),t(A,[t(i,{attrs:{dark:"",text:""},on:{click:function(n){e.putClub(e.club),e.dialog=!1}}},[e._v("Save")])],1)],1),t(a,{staticClass:"ma-5"},[t(c,[t(u,[t(l,{attrs:{cols:"12"}},[t(m,{attrs:{outlined:"",label:"Contact information","auto-grow":""},model:{value:e.club.contact,callback:function(n){e.$set(e.club,"contact",n)},expression:"club.contact"}})],1)],1),t(u,[t(l,{attrs:{cols:"12"}},[t(m,{attrs:{outlined:"",label:"Club description","auto-grow":""},model:{value:e.club.description,callback:function(n){e.$set(e.club,"description",n)},expression:"club.description"}})],1)],1)],1)],1)],1)],1)},V=[];const P={data:()=>({dialog:!1,club:{}}),computed:{p_club(){return this.$store.getters["clubs/clubById"](parseInt(this.$route.params.id))}},methods:{...f("clubs",["putClub"]),c_edit(){this.club=Object.assign({},this.p_club)}}},p={};var D=v(P,j,V,!1,N,null,null,null);function N(e){for(let s in p)this[s]=p[s]}var $=function(){return D.exports}(),B=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.club?t(C,[t(a,[t(_,{domProps:{textContent:e._s(e.club.name+" ("+e.club.name_short+")")}}),t(c,[t("p",{domProps:{innerHTML:e._s(e.club_contact)}}),t("p",{domProps:{innerHTML:e._s(e.club_description)}}),e.user_is_member_or_admin?[t(u,[t(l,{attrs:{cols:"8"}},[e.club.admins&&e.club.admins.includes(e.user.email)?[t($),t(i,{staticClass:"mx-2",attrs:{color:"primary"},on:{click:function(n){return e.addA()}}},[e._v("Add member")])]:e._e()],2),t(l,{attrs:{cols:"4"}},[t(T,{attrs:{"append-icon":"mdi-magnify",label:"Search member","single-line":"","hide-details":""},model:{value:e.m_search,callback:function(n){e.m_search=n},expression:"m_search"}})],1)],1),t(w,{attrs:{dense:"",headers:e.m_table_header,items:e.m_table,search:e.m_search,"items-per-page":50,"multi-sort":""},scopedSlots:e._u([{key:"item.ops",fn:function(n){return[e.club.admins.includes(e.user.email)?[t(o,{staticClass:"mr-2",attrs:{small:""},on:{click:function(r){return e.editA(n.item.id)}}},[e._v(" mdi-pencil ")]),n.item.events?e._e():t(o,{attrs:{small:""},on:{click:function(r){return e.deleteA(n.item.id)}}},[e._v(" mdi-delete ")])]:e._e()]}}],null,!1,1003564087)})]:t("p",[e._v(" Club member list is visible only to club members and club administrators. Also you need to be logged in! ")])],2)],1),t(g,{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(n){e.dialog=n},expression:"dialog"}},[t(a,[t(_,[e._v("Edit Archer profile")]),t(c,[t(z,{model:{value:e.valid,callback:function(n){e.valid=n},expression:"valid"}},[t(x,{attrs:{clubs:[{name:"*_kick out_*",id:1},e.club]},model:{value:e.a_edit,callback:function(n){e.a_edit=n},expression:"a_edit"}})],1)],1),t(I,[t(h),t(i,{attrs:{text:""},on:{click:function(n){e.dialog=!1}}},[e._v("Cancel")]),t(i,{attrs:{color:"primary",text:""},on:{click:function(n){e.putMember(e.a_edit),e.dialog=!1}}},[e._v(e._s(e.action))])],1)],1)],1)],1):t(E,[t(M,{attrs:{indeterminate:"",size:"64"}})],1)},F=[];const H={components:{clubEdit:$,archerDetails:x},data:()=>({m_search:"",valid:!1,action:"",dialog:!1,a_edit:{}}),computed:{...S({user:e=>e.user.user}),club(){return this.$store.getters["clubs/clubById"](parseInt(this.$route.params.id))},m_table_header(){let e=[{text:"Name",value:"full_name"},{text:"Activity",value:"events",width:"90px"}];return this.club.admins.includes(this.user.email)&&e.push({text:"Gender",value:"gender"},{text:"E-mail",value:"email"},{text:"Phone",value:"phone"},{text:"National ID",value:"nat_id"},{text:"Edit",value:"ops",sortable:!1,width:"80px"}),e},m_table(){return Array.isArray(this.club.members)?this.club.members.map(function(e){let s={full_name:e.full_name,events:e.events.length?e.events.length:null};return this.club.admins.includes(this.user.email)?Object.assign(s,{id:e.id,gender:e.gender,email:e.email,phone:e.phone,nat_id:e.nat_id}):s},this):[]},user_is_member_or_admin(){return!this.user.id||this.user.email===""?!1:this.club.admins&&this.club.admins.includes(this.user.email)?!0:Array.isArray(this.club.members)?this.club.members.map(e=>e.email).includes(this.user.email)||this.club.members.map(e=>e.email).includes(this.user.archer.email):!1},club_contact(){return d.sanitize(this.club.contact)},club_description(){return d.sanitize(this.club.description)}},methods:{...f("clubs",["putMember","delMember"]),editA(e){this.a_edit=this.club.members.find(s=>s.id===e),this.action="Save changes",this.dialog=!0},deleteA(e){let s=this.club.members.find(t=>t.id===e);confirm(s.full_name+" will be permanently deleted. This action can not be undone!")&&this.delMember({aId:s.id,cId:s.club})},addA(){this.a_edit={id:null,full_name:"",gender:"",club:this.club.id,email:"",phone:"",nat_id:""},this.action="Add archer",this.dialog=!0}},created(){this.$store.dispatch("clubs/updateClub",parseInt(this.$route.params.id)).catch(()=>{this.$router.push("/clubs")})}},b={};var L=v(H,B,F,!1,O,null,null,null);function O(e){for(let s in b)this[s]=b[s]}var ee=function(){return L.exports}();export{ee as default};
